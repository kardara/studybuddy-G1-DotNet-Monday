@page "/QuizManagement"
@page "/Student/QuizManagement"

<h3>Quiz Management</h3>

<link rel="stylesheet" href="css/QuizLayout.css" />

<div class="container">
    <div class="header">
        <h1>📚 Quiz Management</h1>
        <button class="btn btn-primary" @onclick="OpenModal">+ Create New Quiz</button>
    </div>

    @if (quizzes.Any())
    {
        <div class="quiz-grid">
            @foreach (var quiz in quizzes)
            {
                <div class="quiz-card">
                    <h3>@quiz.Title</h3>
                    <p>@quiz.Description</p>
                    <span class="status">@quiz.Status</span>
                </div>
            }
        </div>
    }
    else
    {
        <div class="empty-state">
            <h2>No Quizzes Yet</h2>
            <p>Create your first quiz to get started!</p>
            <button class="btn btn-primary" @onclick="OpenModal">+ Create Quiz</button>
        </div>
    }
</div>

@if (showModal)
{
    <div class="modal show" style="display:block;">
        <div class="modal-content">
            <h2>Create New Quiz</h2>
            <form>
                <div class="form-group">
                    <label for="quizName">Quiz Title</label>
                    <input type="text" id="quizName" @bind="newQuiz.Title" @bind:event="oninput" placeholder="Enter quiz title" class="form-control" />
                </div>

                <div class="form-group">
                    <label for="quizDescription">Description</label>
                    <textarea id="quizDescription" @bind="newQuiz.Description" @bind:event="oninput" placeholder="Enter quiz description" class="form-control"></textarea>
                </div>

                <div class="form-group">
                    <label for="quizQuestions">Number of Questions</label>
                    <input type="number" id="quizQuestions" @bind="newQuiz.NumberOfQuestions" @bind:event="oninput" class="form-control" />
                </div>

                <div class="form-group">
                    <label for="quizDuration">Duration (minutes)</label>
                    <input type="number" id="quizDuration" @bind="newQuiz.Duration" @bind:event="oninput" class="form-control" />
                </div>

                <div class="form-group">
                    <label for="quizStatus">Status</label>
                    <select id="quizStatus" @bind="newQuiz.Status" class="form-control">
                        <option value="active">Active</option>
                        <option value="draft">Draft</option>
                    </select>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-primary" @onclick="SaveQuiz">Save Quiz</button>
                    <button type="button" class="btn btn-secondary" @onclick="CloseModal">Cancel</button>
                </div>
            </form>
        </div>
    </div>
}

@code {
    private bool showModal = false;
    private List<Quiz> quizzes = new();
    private Quiz newQuiz = new();

    private void OpenModal()
    {
        newQuiz = new Quiz();
        showModal = true;
    }

    private void CloseModal()
    {
        showModal = false;
    }

    private void SaveQuiz()
    {
        if (string.IsNullOrWhiteSpace(newQuiz.Title))
        {
            // Simple validation
            return;
        }

        quizzes.Add(new Quiz
        {
            Title = newQuiz.Title,
            Description = newQuiz.Description,
            NumberOfQuestions = newQuiz.NumberOfQuestions,
            Duration = newQuiz.Duration,
            Status = newQuiz.Status
        });
        showModal = false;
        StateHasChanged();
    }

    public class Quiz
    {
        public string Title { get; set; } = string.Empty;
        public string Description { get; set; } = string.Empty;
        public int NumberOfQuestions { get; set; } = 10;
        public int Duration { get; set; } = 30;
        public string Status { get; set; } = "active";
    }
}